# üéØ Desafio Backend

> Neste projeto eu desenvolvi uma API REST para solucionar os desafios de l√≥gica de neg√≥cios propostos envolvendo c√°lculo de comiss√µes, controle de estoque e c√°lculo de juros compostos.

## üöÄ Tecnologias

| Tecnologia | Vers√£o |
|-----------|--------|
| **Java** | 17+ |
| **Spring Boot** | 3.x (Web) |
| **Maven** | 3.x+ |
| **Lombok** | Latest |

## üìã Funcionalidades

### üí∞ C√°lculo de Comiss√µes de Vendas

Processa uma lista de vendas e calcula a comiss√£o total por vendedor baseada nas seguintes regras:

- Vendas abaixo de R$ 100,00: **Sem comiss√£o**
- Vendas entre R\$ 100,00 e R$ 499,99: **1% de comiss√£o**
- Vendas a partir de R$ 500,00: **5% de comiss√£o**

### üì¶ Controle de Estoque (In-Memory)

Gerencia a entrada e sa√≠da de produtos, validando se h√° estoque suficiente para sa√≠das.

- Mant√©m o estado dos produtos em mem√≥ria
- Gera um identificador √∫nico para cada movimenta√ß√£o
- Possui funcionalidade de **Reset** para facilitar testes manuais

### üìä C√°lculo de Juros

Calcula o valor atualizado de uma d√≠vida baseada em dias de atraso.

- Taxa de multa: **2,5% ao dia** (Juros simples sobre o valor original)

---

## üõ†Ô∏è Como Rodar o Projeto

### Pr√©-requisitos

- Java JDK 17+ instalado
- Maven instalado

### Passo a Passo

1. Clone o reposit√≥rio:

```bash
git clone https://github.com/kyso1/desafio-backend-spring.git
```

1. Entre na pasta do projeto:

```bash
cd desafio-backend-spring
```

1. Execute a aplica√ß√£o via Maven:

```bash
mvn spring-boot:run
```

> A aplica√ß√£o iniciar√° na porta 8080 (ou 8081 se configurado no `application.properties`).

---

## üîå Documenta√ß√£o da API (Endpoints)

Abaixo est√£o os exemplos de requisi√ß√£o para testar cada exerc√≠cio.

### üí∞ Calcular Comiss√µes (Exerc√≠cio 1)

Recebe uma lista de vendas e retorna o total de comiss√£o por vendedor.

**Endpoint:** `POST /api/desafio/comissoes`

**Exemplo de Body (JSON):**

```json
{
  "vendas": [
    { "vendedor": "Jo√£o Silva", "valor": 1200.50 },
    { "vendedor": "Jo√£o Silva", "valor": 950.75 },
    { "vendedor": "Maria Souza", "valor": 90.00 }
  ]
}
```

**Exemplo de Resposta:**

```json
{
  "Jo√£o Silva": 107.56,
  "Maria Souza": 0.00
}
```

---

### üì¶ Movimentar Estoque (Exerc√≠cio 2)

Realiza a entrada ou sa√≠da de mercadorias.

**Endpoint:** `POST /api/desafio/estoque/movimentar`

**Exemplo de Body (JSON) - Entrada:**

```json
{
  "codigoProduto": 101,
  "descricaoMovimentacao": "Entrada NF 550",
  "tipo": "ENTRADA",
  "quantidade": 50
}
```

**Exemplo de Body (JSON) - Sa√≠da:**

```json
{
  "codigoProduto": 104,
  "descricaoMovimentacao": "Venda Balc√£o",
  "tipo": "SAIDA",
  "quantidade": 20
}
```

**Resetar Estoque (Apenas para Testes):**

Como o banco √© em mem√≥ria, use este endpoint para voltar aos valores originais do exerc√≠cio.

**Endpoint:** `POST /api/desafio/estoque/reset`

---

### üìÖ Calcular Juros (Exerc√≠cio 3)

Calcula o valor final de uma conta com base na data de vencimento.

**Endpoint:** `GET /api/desafio/juros`

**Par√¢metros (Query Params):**

- `valor`: Valor original da d√≠vida (ex: 100.00)
- `vencimento`: Data de vencimento no formato YYYY-MM-DD

**Exemplo de URL:**

```bash
http://localhost:8080/api/desafio/juros?valor=100.00&vencimento=2023-01-01
```

---

## üß™ Testes

Os testes podem ser realizados via **Postman** ou **Insomnia** importando as URLs e JSONs descritos acima.

### üìÆ Guia Completo: Testando com Postman

#### 1Ô∏è‚É£ Instalar e Configurar Postman

1. Baixe o Postman em: [https://www.postman.com/downloads/](https://www.postman.com/downloads/)
2. Instale e abra a aplica√ß√£o
3. Crie uma nova cole√ß√£o clicando em `+ New` ‚Üí `Collection`

#### 2Ô∏è‚É£ Testando o Endpoint de Comiss√µes

1. Clique em `+ Add request`
2. Configure:
   - **M√©todo:** `POST`
   - **URL:** `http://localhost:8080/api/desafio/comissoes`
   - **Body:** Selecione `raw` e escolha `JSON`
   - Copie e cole:

```json
{
  "vendas": [
    { "vendedor": "Jo√£o Silva", "valor": 1200.50 },
    { "vendedor": "Jo√£o Silva", "valor": 950.75 },
    { "vendedor": "Maria Souza", "valor": 90.00 }
  ]
}
```

1. Clique em `Send` para executar
2. Voc√™ deve receber uma resposta similar a:

```json
{
  "Jo√£o Silva": 107.56,
  "Maria Souza": 0.00
}
```

#### 3Ô∏è‚É£ Testando o Endpoint de Estoque

**Movimenta√ß√£o de Entrada:**

1. Crie uma nova request `POST`
2. Configure:
   - **URL:** `http://localhost:8080/api/desafio/estoque/movimentar`
   - **Body (raw - JSON):**

```json
{
  "codigoProduto": 101,
  "descricaoMovimentacao": "Entrada NF 550",
  "tipo": "ENTRADA",
  "quantidade": 50
}
```

1. Clique em `Send`

**Movimenta√ß√£o de Sa√≠da:**

1. Crie uma nova request `POST`
2. Configure:
   - **URL:** `http://localhost:8080/api/desafio/estoque/movimentar`
   - **Body (raw - JSON):**

```json
{
  "codigoProduto": 101,
  "descricaoMovimentacao": "Venda Balc√£o",
  "tipo": "SAIDA",
  "quantidade": 20
}
```

1. Clique em `Send`

**Resetar Estoque:**

1. Crie uma nova request `POST`
2. Configure:
   - **URL:** `http://localhost:8080/api/desafio/estoque/reset`
3. Clique em `Send`

#### 4Ô∏è‚É£ Testando o Endpoint de Juros

1. Crie uma nova request `GET`
2. Configure:
   - **URL:** `http://localhost:8080/api/desafio/juros?valor=100.00&vencimento=2023-01-01`
3. Clique em `Send`
4. Voc√™ receber√° o valor atualizado da d√≠vida com os juros calculados

#### üí° Dicas √öteis

- **Salvar requisi√ß√µes:** Todas as requests s√£o salvas automaticamente na cole√ß√£o
- **Ambiente:** Crie um ambiente no Postman com a vari√°vel `base_url = http://localhost:8080` para facilitar
- **Teste r√°pido:** Use `Ctrl + Enter` para enviar requisi√ß√µes rapidamente
- **Hist√≥rico:** Todas as requisi√ß√µes aparecem no hist√≥rico (aba History)

---

### ‚úÖ Testes de Valida√ß√£o Completos (Assertions)

O Postman permite criar testes automatizados para validar as respostas. Abaixo est√£o todas as 5 requisi√ß√µes com seus testes completos:

#### üîß Configura√ß√£o Inicial do Postman

1. Abra o Postman
2. Crie uma **Cole√ß√£o** chamada "Desafio Backend"
3. Crie um **Ambiente** e adicione esta vari√°vel:
   - Nome: `url`
   - Valor: `http://localhost:8080`

---

#### 1Ô∏è‚É£ Requisi√ß√£o: Calcular Comiss√µes

**M√©todo:** `POST`  
**URL:** `{{url}}/api/desafio/comissoes`

**Aba Body (Raw JSON):**

```json
{
    "vendas": [
        { "vendedor": "Jo√£o Silva", "valor": 1200.50 },
        { "vendedor": "Jo√£o Silva", "valor": 950.75 },
        { "vendedor": "Jo√£o Silva", "valor": 1800.00 },
        { "vendedor": "Jo√£o Silva", "valor": 1400.30 },
        { "vendedor": "Jo√£o Silva", "valor": 1100.90 },
        { "vendedor": "Jo√£o Silva", "valor": 1550.00 },
        { "vendedor": "Jo√£o Silva", "valor": 1700.80 },
        { "vendedor": "Jo√£o Silva", "valor": 250.30 },
        { "vendedor": "Jo√£o Silva", "valor": 480.75 },
        { "vendedor": "Jo√£o Silva", "valor": 320.40 },
        { "vendedor": "Maria Souza", "valor": 2100.40 },
        { "vendedor": "Maria Souza", "valor": 1350.60 },
        { "vendedor": "Maria Souza", "valor": 950.20 },
        { "vendedor": "Maria Souza", "valor": 1600.75 },
        { "vendedor": "Maria Souza", "valor": 1750.00 },
        { "vendedor": "Maria Souza", "valor": 1450.90 },
        { "vendedor": "Maria Souza", "valor": 400.50 },
        { "vendedor": "Maria Souza", "valor": 180.20 },
        { "vendedor": "Maria Souza", "valor": 90.75 },
        { "vendedor": "Carlos Oliveira", "valor": 800.50 },
        { "vendedor": "Carlos Oliveira", "valor": 1200.00 },
        { "vendedor": "Carlos Oliveira", "valor": 1950.30 },
        { "vendedor": "Carlos Oliveira", "valor": 1750.80 },
        { "vendedor": "Carlos Oliveira", "valor": 1300.60 },
        { "vendedor": "Carlos Oliveira", "valor": 300.40 },
        { "vendedor": "Carlos Oliveira", "valor": 500.00 },
        { "vendedor": "Carlos Oliveira", "valor": 125.75 },
        { "vendedor": "Ana Lima", "valor": 1000.00 },
        { "vendedor": "Ana Lima", "valor": 1100.50 },
        { "vendedor": "Ana Lima", "valor": 1250.75 },
        { "vendedor": "Ana Lima", "valor": 1400.20 },
        { "vendedor": "Ana Lima", "valor": 1550.90 },
        { "vendedor": "Ana Lima", "valor": 1650.00 },
        { "vendedor": "Ana Lima", "valor": 75.30 },
        { "vendedor": "Ana Lima", "valor": 420.90 },
        { "vendedor": "Ana Lima", "valor": 315.40 }
    ]
}
```

**Aba Tests:**

```javascript
// Verifica se a API respondeu com sucesso
pm.test("Status code √© 200", function () {
    pm.response.to.have.status(200);
});

// Verifica se os vendedores foram processados
pm.test("Retorno cont√©m Jo√£o Silva e comiss√£o calculada", function () {
    var jsonData = pm.response.json();
    pm.expect(jsonData).to.have.property("Jo√£o Silva");
    pm.expect(jsonData["Jo√£o Silva"]).to.be.above(0);
});

pm.test("Retorno cont√©m Maria Souza", function () {
    var jsonData = pm.response.json();
    pm.expect(jsonData).to.have.property("Maria Souza");
});
```

---

#### 2Ô∏è‚É£ Requisi√ß√£o: Entrada de Estoque

**M√©todo:** `POST`  
**URL:** `{{url}}/api/desafio/estoque/movimentar`

**Aba Body (Raw JSON):**

```json
{
    "codigoProduto": 101,
    "descricaoMovimentacao": "Entrada Teste",
    "tipo": "ENTRADA",
    "quantidade": 50
}
```

**Aba Tests:**

```javascript
pm.test("Status code √© 200", function () {
    pm.response.to.have.status(200);
});

pm.test("Estoque atualizado corretamente (150 + 50 = 200)", function () {
    var jsonData = pm.response.json();
    // O produto 101 come√ßa com 150 no JSON original
    pm.expect(jsonData.saldoFinal).to.eql(200);
});
```

---

#### 3Ô∏è‚É£ Requisi√ß√£o: Sa√≠da de Estoque

**M√©todo:** `POST`  
**URL:** `{{url}}/api/desafio/estoque/movimentar`

**Aba Body (Raw JSON):**

```json
{
    "codigoProduto": 104,
    "descricaoMovimentacao": "Sa√≠da Teste",
    "tipo": "SAIDA",
    "quantidade": 20
}
```

**Aba Tests:**

```javascript
pm.test("Status code √© 200", function () {
    pm.response.to.have.status(200);
});

pm.test("Estoque atualizado corretamente (320 - 20 = 300)", function () {
    var jsonData = pm.response.json();
    // O produto 104 come√ßa com 320 no JSON original
    pm.expect(jsonData.saldoFinal).to.eql(300);
});
```

---

#### 4Ô∏è‚É£ Requisi√ß√£o: Calcular Juros (Autom√°tico)

**M√©todo:** `GET`  
**URL:** `{{url}}/api/desafio/juros?valor=100.00&vencimento={{dataVencimento}}`

**Aba Pre-request Script** (IMPORTANTE - copie isso para gerar a data de 10 dias atr√°s automaticamente):

```javascript
// Cria uma data de 10 dias atr√°s
var data = new Date();
data.setDate(data.getDate() - 10);

// Formata para YYYY-MM-DD
var dataFormatada = data.toISOString().split('T')[0];

// Salva na vari√°vel global do Postman
pm.environment.set("dataVencimento", dataFormatada);
```

**Aba Tests:**

```javascript
pm.test("C√°lculo de juros correto (25%)", function () {
    var resposta = pm.response.json();
    // 10 dias * 2.5% = 25% de multa.
    // 100 + 25 = 125
    pm.expect(resposta).to.eql(125.00);
});
```

---

#### üéØ Como Executar Todos os Testes

1. Clique em sua **Collection** "Desafio Backend" (no painel esquerdo)
2. Clique em **Run** (bot√£o azul com ‚ñ∂Ô∏è no topo)
3. Selecione todas as 5 requisi√ß√µes que deseja testar
4. Clique em **Run [Nome da Cole√ß√£o]**
5. Veja os resultados em tempo real com ‚úÖ (passou) ou ‚ùå (falhou)

---

#### üì∏ Resultado dos Testes

Abaixo est√° a screenshot com todos os testes passando:

![Testes Postman - Todos Passando](./imgs/SaidaPostman.png)

---
